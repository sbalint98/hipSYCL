BootStrap: docker
From: archlinux/base

%setup
cp ./install-hipsycl.sh ${SINGULARITY_ROOTFS}/install-hipsycl.sh
cp ./install-cuda.sh ${SINGULARITY_ROOTFS}/install-cuda.sh
cp ./install-base-spack.sh ${SINGULARITY_ROOTFS}/install-base-spack.sh

%post
[ "$HIPSYCL_PKG_BUILD_CUDA" = "ON" ] && bash /install-cuda.sh || echo "Not building CUDA"
pacman -Syu --noconfirm
pacman -S --noconfirm unzip sed wget git python3 parallel tar perl base-devel cmake	
# If we are not building rocm we need to pull it from the pkg repo.sh
#bash /install-cuda.sh 
#bash /install-base-spack.sh
